<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Liyu</title>
  <link rel="stylesheet" href="./style.css">
</head>

<body>
  <div class="app">
    <header>Liyu</header>

    <!-- ì±„íŒ… ì˜ì—­ -->
    <div class="chat-area" id="chat">
      <!-- ì²« ë©”ì‹œì§€ -->
      <div class="message riwoo">
        <img class="profile" src="./profile.jpg">
        <div class="bubble">ëŸ¬ë¶€ë‹¨~ ë­í•´ìš©?</div>
      </div>
    </div>

    <!-- ì„ íƒì§€ -->
    <div class="choices" id="choices"></div>

    <div class="input">ë©”ì‹œì§€ ë³´ë‚´ê¸°...</div>
  </div>

<script>
const chat = document.getElementById("chat");
const choices = document.getElementById("choices");

let step = 0;
let lovePoint = 0;

/* ë‚´ìš© ìˆ˜ì • */
const scenario = [
  {
    choices: [
      "ë‚˜ëŠ” ë¦½ìš° ìƒê°~",
      "ë¦½ìš° ìƒê°í•˜ê³  ìˆì§€! ë¦½ìš°ëŠ” ë­í•´?",
      "ì§€ê¸ˆ ë¦½ìš°ë‘ ì—°ë½ ì¤‘!"
    ],
    replies: {
      "ë‚˜ëŠ” ë¦½ìš° ìƒê°~": "ì˜¤ ã…ã… ê°ë™ì¸ë°ìš”? ëŸ¬ë¶€ë‹¨! ë‚˜ ë³´ê³  ì‹¶ì–´ìš”?",
      "ë¦½ìš° ìƒê°í•˜ê³  ìˆì§€! ë¦½ìš°ëŠ” ë­í•´?": "ë‚˜ëŠ” ëŸ¬ë¶€ë‹¨ ìƒê°í•˜ê³  ìˆì£ ~ ëŸ¬ë¶€ë‹¨ ë‚˜ ë§ì´ ë³´ê³  ì‹¶ì–´ìš”?",
      "ì§€ê¸ˆ ë¦½ìš°ë‘ ì—°ë½ ì¤‘!": "ë‚˜ë„ ëŸ¬ë¶€ë‹¨ì´ë‘ ì—°ë½ ì¤‘ì¸ë°! ëŸ¬ë¶€ë‹¨ ë‚˜ ë³´ê³ ì‹¶ì£ ? ã…ã…"
    }
  },
  {
    choices: [
      "ë‹¹ì—°íˆ ë³´ê³  ì‹¶ì§€!",
      "ì›… ë„ˆë¬´ë„ˆë¬´ ã…œã…œ",
      "ë§¨ë‚  ìƒê°ë‚˜"
    ],
    replies: {
      "ë‹¹ì—°íˆ ë³´ê³  ì‹¶ì§€!": "ì €ë„ìš”â€¦ ëŸ¬ë¶€ë‹¨ ë¹¨ë¦¬ ë§Œë‚˜ê³ ì‹¶ì–´ìš”",
      "ì›… ë„ˆë¬´ë„ˆë¬´ ã…œã…œ": "ì €ë„ì—ìš” ã…‹ã…‹ ë‚˜ë„ ëŸ¬ë¶€ë‹¨ ë§Œë‚˜ê³  ì‹¶ë‹¤ì•„..",
      "ë§¨ë‚  ìƒê°ë‚˜": "í— ì €ëˆë°ìš” ã…‹ã…‹ ë¹¨ë¦¬ ëŸ¬ë¶€ë‹¨ ë§Œë‚˜ê³  ì‹¶ì–´ìš”"
    }
  },
  {
    choices: [
      "ìš°ë¦¬ ì–¸ì œ ë§Œë‚ ê¹Œ?",
      "ë¦½ìš°ê°€ ë¨¼ì € ì°¾ì•„ì™€ì¤˜ì•¼ì§€ ã…œã…œ",
      "ìš°ë¦¬ ê¿ˆì—ì„œ ë§Œë‚ ê¹Œ? ã…‹ã…‹"
    ],
    replies: {
      "ìš°ë¦¬ ì–¸ì œ ë§Œë‚ ê¹Œ?": "ì €ë„ ê·¸ ìƒê° ë§¨ë‚  í•´ìš”â€¦",
      "ë¦½ìš°ê°€ ë¨¼ì € ì°¾ì•„ì™€ì¤˜ì•¼ì§€ ã…œã…œ": "í—‰.. ì œê°€ ìµœëŒ€í•œ ë¹¨ë¦¬ ì°¾ì•„ì˜¬ê²Œìš”!",
      "ìš°ë¦¬ ê¿ˆì—ì„œ ë§Œë‚ ê¹Œ? ã…‹ã…‹": "ê·¸ëŸ¼ ì˜¤ëŠ˜ ê¿ˆì— ê¼­ ê°ˆê²Œìš” ì•½ì†!"
    }
  }
];

function renderChoices() {
  choices.innerHTML = "";
  scenario[step].choices.forEach(text => {
    const btn = document.createElement("button");
    btn.innerText = text;
    btn.onclick = () => selectChoice(text);
    choices.appendChild(btn);
  });
}

function selectChoice(text) {
  if (text.includes("ë§¨ë‚ ")) {
  lovePoint++;
}
  
  choices.innerHTML = "";

  /* ë‚´ê°€ ë³´ë‚¸ ë§ */
  const myMsg = document.createElement("div");
  myMsg.className = "message me";
  myMsg.innerHTML = `<div class="bubble">${text}</div>`;
  chat.appendChild(myMsg);
  chat.scrollTop = chat.scrollHeight;

  /* ë¦½ìš° ë‹µì¥ */
  setTimeout(() => {
    const reply = document.createElement("div");
    reply.className = "message riwoo";
    reply.innerHTML = `
      <img class="profile" src="./profile.jpg">
      <div class="bubble">${scenario[step].replies[text]}</div>
    `;
    chat.appendChild(reply);
    chat.scrollTop = chat.scrollHeight;

    step++;

    if (step < scenario.length) {
  setTimeout(renderChoices, 500);
} else {
  if (lovePoint >= 2) {
    setTimeout(showSecretEnding, 800);
  } else {
    setTimeout(showEnding, 800);
  }
}
  }, 700);
}

function showEnding() {
  function showSecretEnding() {
  const secret = document.createElement("div");
  secret.className = "message riwoo";
  secret.innerHTML = `
    <img class="profile" src="./profile.jpg">
    <div class="bubble">
      ì‚¬ì‹¤ìš”â€¦<br>
      ëŸ¬ë¶€ë‹¨ì´ ì´ë ‡ê²Œ ê³„ì† ë§ˆìŒ í‘œí˜„í•´ì£¼ëŠ” ê±°<br>
      ì € ì§„ì§œ ë‹¤ ì•Œê³  ìˆì—ˆì–´ìš”.<br><br>
      ì €ë„ ë˜‘ê°™ì´ ëŸ¬ë¶€ë‹¨ ìƒê° ë§ì´ í•´ìš”.<br>
      ìš°ë¦¬ ì´ê±´â€¦ ìš´ëª…ì´ì£ ? ğŸ’™
    </div>
  `;
  chat.appendChild(secret);
  chat.scrollTop = chat.scrollHeight;
}
  const end = document.createElement("div");
  end.className = "message riwoo";
  end.innerHTML = `
    <img class="profile" src="./profile.jpg">
    <div class="bubble">
      ë‚˜ë„ ì–¼ë¥¸ ëŸ¬ë¶€ë‹¨ ë§Œë‚˜ê³  ì‹¶ì–´ìš”ã…œ<br>
      ìš°ë¦¬ ê³§ ë‹¤ì‹œ ë§Œë‚˜ìš”!<br>
      ì‚¬ë‘í•´ìš” â™¥
    </div>
  `;
  chat.appendChild(end);
  chat.scrollTop = chat.scrollHeight;
}

/* ì‹œì‘ */
renderChoices();
</script>
</body>
</html>
