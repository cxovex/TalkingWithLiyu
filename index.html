<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Liyu</title>
  <link rel="stylesheet" href="./style.css">
</head>

<body>
  <div class="app">
    <header>Liyu</header>

    <!-- 채팅 영역 -->
    <div class="chat-area" id="chat">
      <!-- 첫 메시지 -->
      <div class="message riwoo">
        <img class="profile" src="./profile.jpg">
        <div class="bubble">러부단~ 뭐해용?</div>
      </div>
    </div>

    <!-- 선택지 -->
    <div class="choices" id="choices"></div>

    <div class="input">메시지 보내기...</div>
  </div>

<script>
const chat = document.getElementById("chat");
const choices = document.getElementById("choices");

let step = 0;

/* 내용 수정 */
const scenario = [
  {
    choices: [
      "나는 립우 생각~",
      "립우 생각하고 있지! 립우는 뭐해?",
      "지금 립우랑 연락 중!"
    ],
    replies: {
      "나는 립우 생각~": "오 ㅎㅎ 감동인데요? 러부단! 나 보고 싶어요?",
      "립우 생각하고 있지! 립우는 뭐해?": "나는 러부단 생각하고 있죠~ 러부단 나 많이 보고 싶어요?",
      "지금 립우랑 연락 중!": "나도 러부단이랑 연락 중인데! 러부단 나 보고싶죠? ㅎㅎ"
    }
  },
  {
    choices: [
      "당연히 보고 싶지!",
      "웅 너무너무 ㅜㅜ",
      "맨날 생각나"
    ],
    replies: {
      "당연히 보고 싶지!": "저도요… 러부단 빨리 만나고싶어요",
      "웅 너무너무 ㅜㅜ": "저도에요 ㅋㅋ 나도 러부단 만나고 싶다아..",
      "맨날 생각나": "헐 저돈데요 ㅋㅋ 빨리 러부단 만나고 싶어요"
    }
  },
  {
    choices: [
      "우리 언제 만날까?",
      "립우가 먼저 찾아와줘야지 ㅜㅜ",
      "우리 꿈에서 만날까? ㅋㅋ"
    ],
    replies: {
      "우리 언제 만날까?": "저도 그 생각 맨날 해요…",
      "립우가 먼저 찾아와줘야지 ㅜㅜ": "헉.. 제가 최대한 빨리 찾아올게요!",
      "우리 꿈에서 만날까? ㅋㅋ": "그럼 오늘 꿈에 꼭 갈게요 약속!"
    }
  }
];

function renderChoices() {
  choices.innerHTML = "";
  scenario[step].choices.forEach(text => {
    const btn = document.createElement("button");
    btn.innerText = text;
    btn.onclick = () => selectChoice(text);
    choices.appendChild(btn);
  });
}

function selectChoice(text) {
  choices.innerHTML = "";

  /* 내가 보낸 말 */
  const myMsg = document.createElement("div");
  myMsg.className = "message me";
  myMsg.innerHTML = `<div class="bubble">${text}</div>`;
  chat.appendChild(myMsg);
  chat.scrollTop = chat.scrollHeight;

  /* 립우 답장 */
  setTimeout(() => {
    const reply = document.createElement("div");
    reply.className = "message riwoo";
    reply.innerHTML = `
      <img class="profile" src="./profile.jpg">
      <div class="bubble">${scenario[step].replies[text]}</div>
    `;
    chat.appendChild(reply);
    chat.scrollTop = chat.scrollHeight;

    step++;

    if (step < scenario.length) {
      setTimeout(renderChoices, 500);
    } else {
      setTimeout(showEnding, 800);
    }
  }, 700);
}

function showEnding() {
  const end = document.createElement("div");
  end.className = "message riwoo";
  end.innerHTML = `
    <img class="profile" src="./profile.jpg">
    <div class="bubble">
      나도 얼른 러부단 만나고 싶어요ㅜ<br>
      우리 곧 다시 만나요!<br>
      사랑해요 ♥
    </div>
  `;
  chat.appendChild(end);
  chat.scrollTop = chat.scrollHeight;
}

/* 시작 */
renderChoices();
</script>
</body>
</html>
